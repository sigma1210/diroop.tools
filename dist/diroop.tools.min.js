!function(e){"use strict";e.module("diroop.tools",["diroop.tools.templateCache","diroop.schema.cache"])}(angular),function(e,t){"use strict";function r(e){function t(){return p().info()}function r(e,t){t&&e&&(s(e),p().put(e,t))}function n(e){return p().get(e)}function o(e){p().remove(e),u(e)}function a(){p().removeAll(),f=[]}function i(){f=[],p().destroy()}function c(){return f}function s(e){l.hasKey(e)||f.push(e)}function u(e){f=_.without(f,e)}function d(e){return _.contains(f,e)}function p(){return m||(m=e(h)),m}var h="drSchemaCache",l={info:t,put:r,get:n,remove:o,removeAll:a,destroy:i,hasKey:d,getUris:c},m=null,f=[];return l}t("drSchemaCache",["$cacheFactory",r])}(angular,angular.module("diroop.tools").factory),function(e,t){"use strict";var r=function(){function e(){function e(){return t}var r={getVersion:e};return r}var t="1.0.0.1.x",r=this;r.setVersion=function(e){t=e},r.$get=[e]};t("drToolsSettings",[r])}(angular,angular.module("diroop.tools").provider),function(e,t){"use strict";function r(t,r,n,o,a){function i(e){return r(function(t,r){a.getValidator().then(function(n){function o(e){c++,c>y?r({message:"Maximum Schema Quota Exceeed"}):d(e).then(function(r){a.addSchema(e,r);var n=a.getMissingUris();0===n.length?t({schema:a.getSchema(i),tv4:a}):o(n[0])})["catch"](function(e){r(e)})}var a=n.freshApi(),i=e,c=0;o(e)})["catch"](function(e){r({message:l,innerError:e})})})}function c(){return r(function(t,r){a.getValidator().then(function(r){var n=r.freshApi();e.forEach(o.getUris(),function(e){n.addSchema(e,o.get(e))}),t({tv4:n,schema:{}})})["catch"](function(e){r({message:l,innerError:e})})})}function s(e){return r(function(t,r){c(e).then(function(n){n.schema={$ref:e},u(n).then(function(e){t(e)})["catch"](function(t){r({message:h,uri:e,innerError:t})})})["catch"](function(t){r({message:h,uri:e,innerError:t})})})}function u(t){return r(function(r,n){function o(r){if(r.$ref){var a=t.tv4.getSchema(r.$ref);return a?r.isBeingHandled?e.copy(a):(r.isBeingHandled=!0,o(e.copy(a))):void n({message:m,$ref:r.$ref})}for(var i in r){var c=r[i];"object"==typeof c&&(delete r[i],r[i]=o(c))}return r}if(t&&t.schema&&t.tv4){var a=o(e.copy(t.schema));a?r(a):n({message:f})}else n({message:g})})}function d(t,n){return r(function(r,n){var a=o.get(t);e.isDefined(a)&&null!==a?r(e.copy(a)):n({message:p,uri:t})})}var p="The current url does not have a a schema stored in drSchemaCache.",h="An error occured expanded schema for uri.",l="An error occured initializing tv4 during schema load.",m="An error occured resolving a url from tv4",f="An unspecified error resulted in a null schema.",g="The schema set did not meet the expected interfacte.",y=1e4,v={getSchemaSet:i,getExpandedSchema:s};return v}t("drSchemaLoader",["$http","$q","$log","drSchemaCache","drTv4Service",r])}(angular,angular.module("diroop.tools").factory),function(e,t){function r(){return function(t,r){var n=t;if(!e.isString(n)||void 0===r)throw{message:"value not a string or replace is undefinebd"};if((e.isString(r)||e.isDate(r)||e.isNumber(r))&&(r=[r]),e.isArray(r)){var o=r.length;n=n.replace(/\$([0-9]+)/g,function(e,t){return t=parseInt(t,10),t>=0&&t<o?r[t]:e})}else{if(!e.isObject(r))throw{message:"unknown replace type"};e.forEach(r,function(e,t){n=n.split(":"+t).join(e)})}return n}}t("sprintf",[r])}(angular,angular.module("diroop.tools").filter),function(e,t,r){"use strict";function n(e,t){function n(){return e(function(e,t){r?e(r):t({message:o})})}var o="TV4 was not loaded. Insure tv4 is referenced.refer to https://github.com/geraintluff/tv4",a={getValidator:n};return a}t("drTv4Service",["$q","$log",n])}(angular,angular.module("diroop.tools").factory,tv4),function(e,t){"use strict";function r(e,t,r){function n(t,n){return e(function(e,i){r.getSchemaSet(t).then(function(r){var a=r.tv4.validateMultiple(n,r.schema);a&&a.valid?e({valid:!0}):i({valid:!1,message:o,errors:a.errors?a.errors:[],missing:a.missing?a.missing:[],schema:t,model:n})})["catch"](function(e){i({message:a})})})}var o="The model did not validate aginst the schema specified",a="An error occured while the schema was being set up for validation",i={validate:n};return i}t("drValidationService",["$q","$log","drSchemaLoader",r])}(angular,angular.module("diroop.tools").factory),function(e,t){"use strict";function r(){function e(e,r,n){e.version=t}var t="v 1.0.0.0";return{templateUrl:"drTemplateCache:/version/version.html",link:e}}t("drToolVersion",["$log",r])}(angular,angular.module("diroop.tools").directive),function(e){try{app=e.module("diroop.schema.cache")}catch(t){app=e.module("diroop.schema.cache",["diroop.tools"])}app.run(["drSchemaCache",function(e){e.put("schemaCache:/address/address.schema.json",{$schema:"http://json-schema.org/draft-04/schema#",description:"An Address following the convention of http://microformats.org/wiki/hcard",type:"object",properties:{"post-office-box":{type:"string"},"extended-address":{type:"string"},"street-address":{type:"string"},locality:{type:"string"},region:{type:"string"},"postal-code":{type:"string"},"country-name":{type:"string"}},required:["locality","region","country-name"],dependencies:{"post-office-box":["street-address"],"extended-address":["street-address"]}})}])}(angular),function(e){try{app=e.module("diroop.schema.cache")}catch(t){app=e.module("diroop.schema.cache",["diroop.tools"])}app.run(["drSchemaCache",function(e){e.put("schemaCache:/geo/geo.schema.json",{$schema:"http://json-schema.org/draft-04/schema#",description:"A geographical coordinate",type:"object",properties:{latitude:{type:"number"},longitude:{type:"number"}}})}])}(angular),function(e){try{app=e.module("diroop.schema.cache")}catch(t){app=e.module("diroop.schema.cache",["diroop.tools"])}app.run(["drSchemaCache",function(e){e.put("schemaCache:/person/bad.schema.json",{$ref:"schemaCache:/noWhereToBeFoundOnPurpose.schema.json"})}])}(angular),function(e){try{app=e.module("diroop.schema.cache")}catch(t){app=e.module("diroop.schema.cache",["diroop.tools"])}app.run(["drSchemaCache",function(e){e.put("schemaCache:/person/hcard.schema.json",{$schema:"http://json-schema.org/draft-04/schema#",description:"A representation of a person, company, organization, or place",type:"object",required:["familyName","givenName"],properties:{fn:{description:"Formatted Name",type:"string"},familyName:{type:"string"},givenName:{type:"string"},additionalName:{type:"array",items:{type:"string"}},honorificPrefix:{type:"array",items:{type:"string"}},honorificSuffix:{type:"array",items:{type:"string"}},nickname:{type:"string"},url:{type:"string",format:"uri"},email:{type:"object",properties:{type:{type:"string"},value:{type:"string",format:"email"}}},tel:{type:"object",properties:{type:{type:"string"},value:{type:"string",format:"phone"}}},adr:{$ref:"schemaCache:/address/address.schema.json"},geo:{$ref:"schemaCache:/geo/geo.schema.json"},tz:{type:"string"},photo:{type:"string"},logo:{type:"string"},sound:{type:"string"},bday:{type:"string",format:"date"},title:{type:"string"},role:{type:"string"},org:{type:"object",properties:{organizationName:{type:"string"},organizationUnit:{type:"string"}}}}})}])}(angular),function(e){try{e=angular.module("diroop.tools.templateCache")}catch(t){e=angular.module("diroop.tools.templateCache",[])}e.run(["$templateCache",function(e){e.put("drTemplateCache:/version/version.html",'<dl class="dl-horizontal"><dt>diroop.tools :</dt><dd><small>{{version}}</small></dd></dl>')}])}();
//# sourceMappingURL=diroop.tools.min.js.map
